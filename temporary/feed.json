{
  "openapi": "3.0.4",
  "info": {
    "title": "Feed Management API",
    "version": "v2.0.0-alpha"
  },
  "servers": [
    {
      "url": "/feed"
    }
  ],
  "paths": {
    "/Feeds/{id}": {
      "get": {
        "tags": [
          "Feeds"
        ],
        "summary": "Returns single item based on primary key value",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "x-tenant",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/Feed"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Feed"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/Feed"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/Feeds/{id}/metadata": {
      "get": {
        "tags": [
          "Feeds"
        ],
        "summary": "Returns metadata of the entity with the specified primary key value",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "x-tenant",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "if the metadata can be fetched (although it may be empty)",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/MetadataValue"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/MetadataValue"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/MetadataValue"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error"
          },
          "400": {
            "description": "If the item type does not support metada",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "404": {
            "description": "if there is no item with sent id"
          }
        }
      }
    },
    "/Feeds": {
      "get": {
        "tags": [
          "Feeds"
        ],
        "summary": "Get all items based on (lazy) load parameters (paging, sorting, and filtering)",
        "parameters": [
          {
            "name": "First",
            "in": "query",
            "description": "Starting row (i.e. skips First rows)",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "Rows",
            "in": "query",
            "description": "Number of elements to return",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "Sort",
            "in": "query",
            "description": "Name of a column. Must be same as in corresponding DTO object, case insensitive\nIn case of multiple columns, separated them with comma and without spaces",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "SortOrder",
            "in": "query",
            "description": "1 ascending, -1 descending",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "Filter",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "UseANDFor",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "x-tenant",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/FeedItems"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeedItems"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeedItems"
                }
              }
            }
          }
        }
      }
    },
    "/Feeds/ProjectTo": {
      "get": {
        "tags": [
          "Feeds"
        ],
        "summary": "Get all items based on (lazy) load parameters (paging, sorting, and filtering)\nbut project result to columns list (i.e. subset of possible data)",
        "parameters": [
          {
            "name": "columns",
            "in": "query",
            "description": "Comma separated list of columns (use AS name for alias), e.g. id,code as C,name",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "First",
            "in": "query",
            "description": "Starting row (i.e. skips First rows)",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "Rows",
            "in": "query",
            "description": "Number of elements to return",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "Sort",
            "in": "query",
            "description": "Name of a column. Must be same as in corresponding DTO object, case insensitive\nIn case of multiple columns, separated them with comma and without spaces",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "SortOrder",
            "in": "query",
            "description": "1 ascending, -1 descending",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "Filter",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "UseANDFor",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "x-tenant",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/Items"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Items"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/Items"
                }
              }
            }
          }
        }
      }
    },
    "/Feeds/Count": {
      "get": {
        "tags": [
          "Feeds"
        ],
        "summary": "Get number of item satisfying filters",
        "parameters": [
          {
            "name": "filter",
            "in": "query",
            "description": "Each filter is like  key(operator)value, e.g. client(contains)Bob, agency(=)TNT",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "useANDFor",
            "in": "query",
            "description": "List of columns that use AND instead of OR to merge multiple filters with the same key",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "x-tenant",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "integer",
                  "format": "int32"
                }
              },
              "application/json": {
                "schema": {
                  "type": "integer",
                  "format": "int32"
                }
              },
              "text/json": {
                "schema": {
                  "type": "integer",
                  "format": "int32"
                }
              }
            }
          }
        }
      }
    },
    "/Feeds/AsExcel": {
      "get": {
        "tags": [
          "Feeds"
        ],
        "summary": "Export data to excel\nUse columns as comma separated list if you need to specify which columns should be included in the result\nAlias may be used (e.g. columns could be FieldA, FieldB AS FB, FieldC",
        "parameters": [
          {
            "name": "columns",
            "in": "query",
            "description": "",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "First",
            "in": "query",
            "description": "Starting row (i.e. skips First rows)",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "Rows",
            "in": "query",
            "description": "Number of elements to return",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "Sort",
            "in": "query",
            "description": "Name of a column. Must be same as in corresponding DTO object, case insensitive\nIn case of multiple columns, separated them with comma and without spaces",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "SortOrder",
            "in": "query",
            "description": "1 ascending, -1 descending",
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "Filter",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "UseANDFor",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "x-tenant",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "post": {
        "tags": [
          "Feeds"
        ],
        "summary": "Export data to excel. Use LoadParams (i.e., First, Rows, Filter, UseANDFor) to get a subset of the data,\notherwise all rows would be fetched\nUse Columns to select which fields (and in which order) should be exported to excel. \nColumns key must be present, although it may be an empty array. In that case all properties from the DTO are returned\nFor each column Field (i.e. propery name) must be specified, and optionally header text (Title) for the field\nIf the field is numeric or date, you may use NumberFormat or DateFormat to set Excel format for the field.",
        "parameters": [
          {
            "name": "x-tenant",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExportRequest"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/ExportRequest"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/ExportRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/Feeds/Agg": {
      "get": {
        "tags": [
          "Feeds"
        ],
        "summary": "Get the value specified by the aggregate function (min, max, avg, sum) of items satisfying filters\nIf there are no data in the result, then the results in empty (204-No Content)",
        "parameters": [
          {
            "name": "function",
            "in": "query",
            "description": "Sum, Min, Max, Avg, as defined in MobilityOne.Common.Queries.Generic.AggregateFunction",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "aggregateField",
            "in": "query",
            "description": "One of allowed aggregate fields in DTO",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "filter",
            "in": "query",
            "description": "Each filter is like  key(operator)value, e.g. client(contains)Bob, agency(=)TNT",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "useANDFor",
            "in": "query",
            "description": "List of columns that use AND instead of OR to merge multiple filters with the same key",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "x-tenant",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "number",
                  "format": "double",
                  "nullable": true
                }
              },
              "application/json": {
                "schema": {
                  "type": "number",
                  "format": "double",
                  "nullable": true
                }
              },
              "text/json": {
                "schema": {
                  "type": "number",
                  "format": "double",
                  "nullable": true
                }
              }
            }
          },
          "204": {
            "description": "No Content"
          }
        }
      }
    },
    "/Feeds/GroupBy": {
      "get": {
        "tags": [
          "Feeds"
        ],
        "parameters": [
          {
            "name": "filter",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "useANDFor",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          {
            "name": "groupBy",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "function",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "aggregateField",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "x-tenant",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/AggregatedData"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AggregatedData"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/AggregatedData"
                }
              }
            }
          }
        }
      }
    },
    "/Lookup/FeedSourceTypes": {
      "get": {
        "tags": [
          "Lookup"
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FeedSourceType"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FeedSourceType"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FeedSourceType"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AggregatedData": {
        "type": "object",
        "properties": {
          "Data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ObjectDecimalKeyValuePair"
            },
            "description": "Key is Json containing all group by properties\nValue is an aggregate value",
            "nullable": true
          },
          "Total": {
            "type": "number",
            "format": "double",
            "readOnly": true
          }
        },
        "additionalProperties": false
      },
      "ExportColumn": {
        "required": [
          "Field"
        ],
        "type": "object",
        "properties": {
          "Field": {
            "minLength": 1,
            "type": "string"
          },
          "Title": {
            "type": "string",
            "nullable": true
          },
          "NumberFormat": {
            "type": "string",
            "nullable": true
          },
          "DateFormat": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "ExportRequest": {
        "required": [
          "Columns"
        ],
        "type": "object",
        "properties": {
          "LoadParams": {
            "$ref": "#/components/schemas/LoadParams"
          },
          "Columns": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ExportColumn"
            }
          }
        },
        "additionalProperties": false
      },
      "Feed": {
        "type": "object",
        "properties": {
          "Id": {
            "type": "integer",
            "format": "int32"
          },
          "TenantId": {
            "type": "string",
            "format": "uuid"
          },
          "VehicleId": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "SourceId": {
            "type": "string",
            "nullable": true
          },
          "SourceType": {
            "type": "integer",
            "format": "int32"
          },
          "SourceTypeName": {
            "type": "string",
            "nullable": true,
            "readOnly": true
          },
          "JsonContent": {
            "type": "string",
            "nullable": true
          },
          "Time": {
            "type": "string",
            "format": "date-time"
          },
          "Initiator": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "FeedItems": {
        "type": "object",
        "properties": {
          "Data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Feed"
            },
            "nullable": true
          },
          "Count": {
            "type": "integer",
            "format": "int32"
          }
        },
        "additionalProperties": false,
        "description": "Contains requested items (based on filter, paging and sorting criteria),\nand the number of total items satisfying the filter\n(or count of all items if no filter is present)"
      },
      "FeedSourceType": {
        "type": "object",
        "properties": {
          "Name": {
            "type": "string",
            "nullable": true,
            "readOnly": true
          },
          "Id": {
            "type": "integer",
            "format": "int32",
            "readOnly": true
          }
        },
        "additionalProperties": false
      },
      "Items": {
        "type": "object",
        "properties": {
          "Data": {
            "type": "array",
            "items": { },
            "nullable": true
          },
          "Count": {
            "type": "integer",
            "format": "int32"
          }
        },
        "additionalProperties": false,
        "description": "Non generic variant. Used when result should be projected to an anonymous class"
      },
      "LoadParams": {
        "type": "object",
        "properties": {
          "Filter": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          },
          "UseANDFor": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          },
          "First": {
            "type": "integer",
            "description": "Starting row (i.e. skips First rows)",
            "format": "int32",
            "nullable": true
          },
          "Rows": {
            "type": "integer",
            "description": "Number of elements to return",
            "format": "int32",
            "nullable": true
          },
          "Sort": {
            "type": "string",
            "description": "Name of a column. Must be same as in corresponding DTO object, case insensitive\nIn case of multiple columns, separated them with comma and without spaces",
            "nullable": true
          },
          "SortOrder": {
            "type": "integer",
            "description": "1 ascending, -1 descending",
            "format": "int32",
            "nullable": true
          },
          "Ascending": {
            "type": "boolean",
            "readOnly": true
          }
        },
        "additionalProperties": false,
        "description": "Map lazy loading parameters (e.g. from PrimeNG table)"
      },
      "MetadataValue": {
        "type": "object",
        "properties": {
          "Id": {
            "type": "integer",
            "format": "int32"
          },
          "MetadataId": {
            "type": "integer",
            "format": "int32"
          },
          "ColumnName": {
            "type": "string",
            "nullable": true
          },
          "Value": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "ObjectDecimalKeyValuePair": {
        "type": "object",
        "properties": {
          "Key": {
            "nullable": true
          },
          "Value": {
            "type": "number",
            "format": "double"
          }
        },
        "additionalProperties": false
      },
      "ProblemDetails": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "nullable": true
          },
          "title": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "detail": {
            "type": "string",
            "nullable": true
          },
          "instance": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": { }
      }
    },
    "securitySchemes": {
      "Bearer": {
        "type": "http",
        "description": "Paste only token",
        "scheme": "bearer"
      }
    }
  },
  "security": [
    {
      "Bearer": [ ]
    }
  ]
}